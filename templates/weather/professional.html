{% include 'logo_data.jinja2' %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Weather Report - {{ location }}</title>
    <style>
        body {
            font-family: 'Helvetica', Arial, sans-serif;
            font-size: 12pt;
            line-height: 1.4;
            color: #333;
            margin: 0;
            padding: 0;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 20px;
        }
        
        .header-logo {
            max-width: 60px;
            max-height: 60px;
            margin-bottom: 15px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 24pt;
            margin: 0;
        }
        
        .header h2 {
            color: #7f8c8d;
            font-size: 16pt;
            margin: 10px 0 0 0;
            font-weight: normal;
        }
        
        .summary-box {
            background-color: #ecf0f1;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .current-weather {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .weather-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }
        
        .weather-item h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 14pt;
        }
        
        .weather-value {
            font-size: 18pt;
            font-weight: bold;
            color: #e74c3c;
        }
        
        .forecast-section {
            margin: 30px 0;
        }
        
        .forecast-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .forecast-table th,
        .forecast-table td {
            border: 1px solid #bdc3c7;
            padding: 12px;
            text-align: left;
        }
        
        .forecast-table th {
            background-color: #34495e;
            color: white;
            font-weight: bold;
        }
        
        .forecast-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .risk-assessment {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .risk-assessment.high {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        
        .risk-assessment.medium {
            background-color: #fff3cd;
            border-color: #ffeaa7;
        }
        
        .risk-assessment.low {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        .historical-section {
            margin: 30px 0;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #bdc3c7;
            text-align: center;
            color: #7f8c8d;
            font-size: 10pt;
        }
        
        .footer-logo {
            max-width: 50px;
            max-height: 50px;
            margin-bottom: 10px;
            opacity: 0.7;
        }
        
        .page-break {
            page-break-before: always;
        }
    </style>
</head>
<body>
    <div class="header">
        {% if logo_base64 or default_logo_base64 %}
        <img class="header-logo" src="data:image/png;base64,{{ logo_base64 or default_logo_base64 }}" alt="ApexOS Logo">
        {% endif %}
        <h1>Professional Weather Report</h1>
        <h2>{{ location }}</h2>
        <p>Generated on {{ generated_at }}</p>
    </div>

    <!-- Executive Summary -->
    <div class="summary-box">
        <h3>Executive Summary</h3>
        <p>This comprehensive weather report provides detailed analysis for {{ location }}, including current conditions, 
        forecast data, historical trends, and risk assessment. The analysis covers the period from 
        {{ weather_data.date_range.start if weather_data.date_range else 'N/A' }} to 
        {{ weather_data.date_range.end if weather_data.date_range else 'N/A' }}.</p>
    </div>

    <!-- Current Weather -->
    <div class="current-weather">
        <div class="weather-item">
            <h3>Temperature</h3>
            <div class="weather-value">{{ current.temperature | format_temp(current.temperatureUnit) }}</div>
        </div>
        <div class="weather-item">
            <h3>Condition</h3>
            <div class="weather-value">{{ current.condition }}</div>
        </div>
        <div class="weather-item">
            <h3>Wind Speed</h3>
            <div class="weather-value">{{ current.windSpeed | format_wind }}</div>
        </div>
        <div class="weather-item">
            <h3>Wind Direction</h3>
            <div class="weather-value">{{ current.windDirection }}</div>
        </div>
    </div>

    <!-- Detailed Current Conditions -->
    <div class="summary-box">
        <h3>Detailed Current Conditions</h3>
        <p><strong>Detailed Forecast:</strong> {{ current.detailedForecast }}</p>
        {% if current.humidity %}
        <p><strong>Humidity:</strong> {{ current.humidity }}%</p>
        {% endif %}
        {% if current.pressure %}
        <p><strong>Pressure:</strong> {{ current.pressure }} inHg</p>
        {% endif %}
        {% if current.visibility %}
        <p><strong>Visibility:</strong> {{ current.visibility }} miles</p>
        {% endif %}
    </div>

    <!-- Weather Forecast -->
    {% if forecast and forecast.periods %}
    <div class="forecast-section">
        <h3>7-Day Weather Forecast</h3>
        <table class="forecast-table">
            <thead>
                <tr>
                    <th>Period</th>
                    <th>Temperature</th>
                    <th>Condition</th>
                    <th>Wind</th>
                    <th>Precipitation</th>
                </tr>
            </thead>
            <tbody>
                {% for period in forecast.periods[:7] %}
                <tr>
                    <td>{{ period.name }}</td>
                    <td>{{ period.temperature }}{{ period.temperatureUnit }}</td>
                    <td>{{ period.shortForecast }}</td>
                    <td>{{ period.windSpeed }} {{ period.windDirection }}</td>
                    <td>{{ period.probabilityOfPrecipitation.value if period.probabilityOfPrecipitation else 'N/A' }}%</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <!-- Risk Assessment -->
    {% if risk_assessment %}
    <div class="risk-assessment {{ risk_assessment.overallRisk | lower }}">
        <h3>Risk Assessment</h3>
        <p><strong>Overall Risk Level:</strong> {{ risk_assessment.overallRisk }}</p>
        {% if risk_assessment.weatherRisk %}
        <p><strong>Weather Risk:</strong> {{ risk_assessment.weatherRisk }}</p>
        {% endif %}
        {% if risk_assessment.stormRisk %}
        <p><strong>Storm Risk:</strong> {{ risk_assessment.stormRisk }}</p>
        {% endif %}
        {% if risk_assessment.recommendations %}
        <p><strong>Recommendations:</strong> {{ risk_assessment.recommendations }}</p>
        {% endif %}
    </div>
    {% endif %}

    <!-- Historical Data -->
    {% if historical %}
    <div class="historical-section">
        <h3>Historical Weather Analysis</h3>
        <div class="summary-box">
            {% if historical.avgTemperature %}
            <p><strong>Average Temperature:</strong> {{ historical.avgTemperature }}Â°F</p>
            {% endif %}
            {% if historical.totalPrecipitation %}
            <p><strong>Total Precipitation:</strong> {{ historical.totalPrecipitation }} inches</p>
            {% endif %}
            {% if historical.stormEvents %}
            <p><strong>Storm Events:</strong> {{ historical.stormEvents }}</p>
            {% endif %}
            {% if historical.extremeWeatherDays %}
            <p><strong>Extreme Weather Days:</strong> {{ historical.extremeWeatherDays }}</p>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Footer -->
    <div class="footer">
        {% if logo_base64 or default_logo_base64 %}
        <img class="footer-logo" src="data:image/png;base64,{{ logo_base64 or default_logo_base64 }}" alt="ApexOS Logo">
        {% endif %}
        <p>This report was generated by the Weather Reports Service</p>
        <p>For questions or additional information, please contact your weather service provider</p>
    </div>
</body>
</html>